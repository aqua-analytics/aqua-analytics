# 📖 실험실 품질관리 대시보드 사용자 가이드

> 실험실 품질관리 대시보드의 모든 기능을 효과적으로 활용하기 위한 완전한 사용자 가이드

## 📋 목차

1. [시작하기](#시작하기)
2. [파일 업로드 및 검증](#파일-업로드-및-검증)
3. [대시보드 탐색](#대시보드-탐색)
4. [데이터 분석 기능](#데이터-분석-기능)
5. [보고서 생성](#보고서-생성)
6. [고급 기능](#고급-기능)
7. [문제 해결](#문제-해결)

## 🚀 시작하기

### 시스템 접속

1. **웹 브라우저 열기**
   - 권장 브라우저: Chrome, Firefox, Safari, Edge 최신 버전
   - 주소창에 `http://localhost:8501` 입력

2. **초기 화면 확인**
   - 좌측: 사이드바 네비게이션 패널
   - 우측: 메인 콘텐츠 영역
   - 상단: 애플리케이션 제목 및 상태 표시

### 인터페이스 구성

```
┌─ 사이드바 ─────┬─ 메인 콘텐츠 ─────────────────────┐
│ 🧪 분석 시스템  │ 실험실 품질관리 대시보드           │
│                │                                  │
│ 현재 조회 파일  │ ┌─ 파일 업로드 영역 ─────────────┐ │
│ • 파일1.xlsx   │ │ 📁 Excel 파일을 드래그하세요    │ │
│ • 파일2.xlsx   │ └─────────────────────────────┘ │
│                │                                  │
│ 메뉴           │ ┌─ 분석 결과 ─────────────────────┐ │
│ 📊 처리 대기    │ │ KPI 카드 | 차트 | 테이블       │ │
│ 📄 성적서 목록  │ └─────────────────────────────┘ │
│ 📋 규격 목록    │                                  │
└───────────────┴──────────────────────────────────┘
```

## 📁 파일 업로드 및 검증

### 지원되는 파일 형식

- **Excel 파일**: `.xlsx`, `.xls`
- **최대 크기**: 50MB (기본 설정)
- **데이터 구조**: 27개 컬럼 표준 형식

### 파일 업로드 방법

#### 방법 1: 드래그 앤 드롭 (권장)

1. **파일 준비**
   - 분석할 Excel 파일을 준비
   - 파일명은 `프로젝트명_날짜.xlsx` 형식 권장

2. **업로드 실행**
   - 파일을 업로드 영역으로 드래그
   - "파일을 여기에 드롭하세요" 메시지 확인
   - 파일을 놓으면 자동 업로드 시작

#### 방법 2: 파일 선택

1. **업로드 버튼 클릭**
   - "파일 선택" 버튼 클릭
   - 파일 탐색기에서 Excel 파일 선택

2. **업로드 확인**
   - 선택된 파일명 확인
   - "업로드" 버튼 클릭

### 파일 검증 과정

업로드된 파일은 자동으로 다음 검증을 거칩니다:

#### 1. 기본 검증
- ✅ **파일 형식**: Excel 파일 여부 확인
- ✅ **파일 크기**: 최대 크기 제한 확인
- ✅ **파일 무결성**: 손상된 파일 여부 확인

#### 2. 데이터 구조 검증
- ✅ **필수 컬럼**: 시료명, 시험항목, 결과 컬럼 존재 확인
- ✅ **데이터 타입**: 각 컬럼의 데이터 타입 검증
- ✅ **데이터 완성도**: 필수 데이터 누락 여부 확인

#### 3. 검증 결과 표시

**성공 시:**
```
✅ 파일 검증 완료
📊 총 1,234건의 데이터 발견
⚠️ 부적합 항목 56건 감지
```

**실패 시:**
```
❌ 파일 검증 실패
🔧 문제: 필수 컬럼 '시료명'이 없습니다
💡 해결방법: Excel 파일의 컬럼명을 확인하세요
```

## 🎛️ 대시보드 탐색

### 사이드바 네비게이션

#### 현재 조회 파일 섹션
- **파일 목록**: 업로드된 파일들의 목록
- **활성 파일**: 현재 분석 중인 파일 (✓ 표시)
- **파일 전환**: 다른 파일 클릭으로 즉시 전환

#### 메인 메뉴 섹션
- **📊 처리 대기 파일**: 파일 업로드 및 분석 페이지
- **📄 시험성적서 목록**: 생성된 성적서 관리 페이지
- **📋 규격 목록**: 시험 규격 문서 관리 페이지

### 메인 콘텐츠 영역

#### 동적 헤더
```
[파일명] 분석 보고서 대시보드    [시험성적서 미리보기]
```
- **제목**: 현재 분석 중인 파일명 표시
- **미리보기 버튼**: 성적서 생성 및 미리보기

#### 4단계 구성
1. **KPI 카드**: 핵심 지표 요약
2. **시각화 차트**: 부적합 통계 차트
3. **데이터 테이블**: 상세 데이터 목록
4. **상세 정보**: 선택된 항목의 세부 정보

## 📊 데이터 분석 기능

### KPI 카드 섹션

#### 표시되는 지표
```
┌─ 총 시험 항목 ─┬─ 부적합 항목 ─┬─ 부적합 비율 ─┬─ 총 시료 개수 ─┐
│    1,234건     │     56건     │    4.5%     │     89개     │
│      📊       │      ⚠️      │     📈      │     🧪      │
└───────────────┴─────────────┴─────────────┴─────────────┘
```

#### 지표 해석
- **총 시험 항목**: 전체 분석된 시험 건수
- **부적합 항목**: 기준값을 초과한 시험 건수
- **부적합 비율**: 전체 대비 부적합 비율 (%)
- **총 시료 개수**: 분석된 고유 시료 개수

### 시각화 차트 섹션

#### 도넛 차트 (부적합 항목별 분포)
- **용도**: 부적합 항목의 종류별 분포 확인
- **상호작용**: 차트 영역 클릭으로 필터링
- **색상**: 항목별 고유 색상으로 구분

#### 수평 막대 차트 (시료별 부적합 현황)
- **용도**: 시료별 부적합 건수 비교
- **정렬**: 부적합 건수 내림차순
- **제한**: 상위 10개 시료만 표시

### 인터랙티브 데이터 테이블

#### 기본 기능

**컬럼 구성:**
- 시료명
- 분석번호
- 시험항목
- 결과값
- 판정 (적합/부적합)

**시각적 표시:**
- 부적합 행: 빨간색 배경 강조
- 선택된 행: 파란색 테두리
- 호버 효과: 마우스 오버 시 하이라이트

#### 고급 기능

**1. 정렬 기능**
```
클릭 → 오름차순 정렬
다시 클릭 → 내림차순 정렬
다시 클릭 → 원래 순서
```

**2. 검색 기능**
- 테이블 상단 검색창 사용
- 실시간 필터링 적용
- 모든 컬럼에서 검색 가능

**3. 필터링 기능**
- 판정 상태별 필터링
- 시료명별 필터링
- 시험항목별 필터링

**4. 행 선택 기능**
- 행 클릭으로 선택
- 선택된 행의 상세 정보 우측 패널에 표시

### 상세 정보 패널

#### 시료 정보 섹션
```
┌─ 시료 정보 ─────────────────────┐
│ 시료명: 샘플_A_001              │
│ 분석번호: 2024-001-001          │
│ 시험자: 김실험                  │
│ 입력일시: 2024-01-15 14:30      │
└─────────────────────────────────┘
```

#### 시험 규격 정보 섹션
```
┌─ 시험 규격 정보 ─────────────────┐
│ 시험항목: 대장균                │
│ 기준값: ≤ 10 CFU/g             │
│ 시험표준: KS H 1234            │
│ 관련 규격: [규격문서.pdf] 📎    │
└─────────────────────────────────┘
```

#### 규격 문서 연동
1. **규격 링크 클릭**
   - 파란색 밑줄 링크 클릭
   - 바텀 시트가 화면 하단에서 슬라이드 업

2. **바텀 시트 기능**
   - 규격 문서 미리보기
   - 다운로드 버튼
   - 닫기 버튼 (X)

## 📄 보고서 생성

### 시험성적서 미리보기

#### 미리보기 실행
1. **미리보기 버튼 클릭**
   - 우측 상단 "시험성적서 미리보기" 버튼 클릭
   - 모달 팝업이 화면 중앙에 표시

2. **미리보기 내용**
   - 회사 로고 및 헤더 정보
   - 프로젝트 정보 및 분석 기간
   - 시험 결과 테이블
   - 부적합 항목 자동 하이라이트

#### 미리보기 모달 기능

```
┌─ 시험성적서 미리보기 ─────────────────────── [X] ─┐
│                                                  │
│  [회사 로고]     실험실 품질관리 시험성적서        │
│                                                  │
│  프로젝트: 샘플분석_2024_PJT                     │
│  분석기간: 2024-01-15 ~ 2024-01-20              │
│                                                  │
│  ┌─ 시험 결과 ───────────────���─────────────────┐ │
│  │ 시료명 │ 시험항목 │ 결과 │ 기준값 │ 판정   │ │
│  │ 샘플A  │ 대장균   │ 15   │ ≤10   │ 부적합 │ │
│  └─────────────────────────────────────────────┘ │
│                                                  │
│              [인쇄]    [PDF 저장]                │
└──────────────────────────────────────────────────┘
```

#### 보고서 내보내기

**1. PDF 저장**
- "PDF 저장" 버튼 클릭
- 브라우저 다운로드 폴더에 PDF 파일 저장
- 파일명: `시험성적서_[프로젝트명]_[날짜].pdf`

**2. 인쇄**
- "인쇄" 버튼 클릭
- 브라우저 인쇄 대화상자 열림
- 프린터 설정 후 인쇄 실행

### HTML 보고서 생성

#### 자동 생성 기능
- 파일 분석 완료 시 자동으로 HTML 보고서 생성
- `reports/` 폴더에 저장
- 파일명: `[프로젝트명]_[타임스탬프].html`

#### 보고서 내용
- 프로젝트 개요 및 요약
- KPI 지표 및 차트
- 상세 데이터 테이블
- 부적합 항목 분석
- 개선 권고사항

## 🔧 고급 기능

### HTML 템플릿 모드

#### 모드 전환
- 대시보드 우측 상단 "HTML 템플릿 사용" 체크박스
- 체크 시: HTML 템플릿 기반 렌더링
- 해제 시: Streamlit 네이티브 렌더링

#### HTML 템플릿 장점
- 더 빠른 렌더링 속도
- 더 풍부한 인터랙션
- ApexCharts 기반 고급 차트
- TailwindCSS 기반 모던 디자인

### 파일 히스토리 관리

#### 업로드 히스토리 확인
1. **히스토리 패널 열기**
   - 파일 업로드 페이지 하단 "📁 업로드 히스토리" 확장

2. **히스토리 정보**
   - 파일명 및 업로드 시간
   - 처리 상태 (완료/대기)
   - 데이터 건수
   - 활성 파일 표시

#### 파일 전환
- 히스토리에서 "선택" 버튼 클릭
- 즉시 해당 파일로 전환
- 기존 분석 결과 유지

### 성능 모니터링

#### 시스템 상태 확인
- 브라우저 개발자 도구 (F12) 열기
- Console 탭에서 성능 로그 확인
- Network 탭에서 로딩 시간 확인

#### 메모리 사용량 최적화
- 대용량 파일 처리 시 자동 최적화
- 불필요한 데이터 자동 정리
- 캐시 시스템 활용

## ❗ 문제 해결

### 일반적인 문제들

#### 1. 파일 업로드 실패

**증상:**
- 파일 드래그 시 반응 없음
- "파일 업로드 실패" 에러 메시지

**해결방법:**
```
1. 파일 크기 확인 (50MB 이하)
2. 파일 형식 확인 (.xlsx, .xls)
3. 파일 손상 여부 확인
4. 브라우저 새로고침 (Ctrl+F5)
5. 다른 브라우저에서 시도
```

#### 2. 데이터 분석 오류

**증상:**
- "데이터 처리 중 오류 발생" 메시지
- 빈 대시보드 표시

**해결방법:**
```
1. Excel 파일의 컬럼명 확인
   - 필수: 시료명, 시험항목, 결과
2. 데이터 형식 확인
   - 결과 컬럼: 숫자 형식
   - 날짜 컬럼: 날짜 형식
3. 빈 행/열 제거
4. 특수문자 제거
```

#### 3. 차트 표시 오류

**증상:**
- 차트 영역이 비어있음
- "차트 로딩 실패" 메시지

**해결방법:**
```
1. 브라우저 JavaScript 활성화 확인
2. 광고 차단기 비활성화
3. 브라우저 캐시 삭제
4. 페이지 새로고침
```

#### 4. 성능 저하

**증상:**
- 페이지 로딩이 느림
- 인터랙션 반응 지연

**해결방법:**
```
1. 브라우저 탭 개수 줄이기
2. 다른 프로그램 종료
3. 브라우저 재시작
4. 시스템 재부팅
```

### 에러 메시지 해석

#### 파일 관련 에러
```
❌ "지원되지 않는 파일 형식"
→ .xlsx 또는 .xls 파일만 업로드 가능

❌ "파일 크기가 너무 큽니다"
→ 50MB 이하의 파일만 업로드 가능

❌ "파일이 손상되었습니다"
→ Excel에서 파일을 다시 저장 후 시도
```

#### 데이터 관련 에러
```
❌ "필수 컬럼이 없습니다"
→ 시료명, 시험항목, 결과 컬럼 확인

❌ "데이터 형식이 올바르지 않습니다"
→ 결과 컬럼의 숫자 형식 확인

❌ "기준값을 찾을 수 없습니다"
→ 시험항목별 기준값 설정 확인
```

### 지원 요청

문제가 지속될 경우:

1. **로그 정보 수집**
   - 브라우저 개발자 도구 Console 로그
   - 에러 메시지 스크린샷
   - 사용 중인 파일 샘플

2. **시스템 정보 확인**
   - 운영체제 및 버전
   - 브라우저 종류 및 버전
   - 파일 크기 및 형식

3. **지원팀 연락**
   - 이메일: support@example.com
   - 이슈 리포트: GitHub Issues
   - 전화: 1588-0000

---

**📚 추가 도움말**
- [API 문서](api_documentation.md) - 개발자용 기술 문서
- [배포 가이드](deployment_guide.md) - 시스템 관리자용 가이드
- [FAQ](faq.md) - 자주 묻는 질문과 답변